<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fruitful - Premium Survey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

      body {
        font-family: "Inter", sans-serif;
      }

      .survey-step {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .option-card {
        transition: all 0.2s ease;
      }

      .option-card:hover {
        transform: translateY(-2px);
        border-color: #10b981;
        background-color: #f0fdf4;
      }

      .option-card.selected {
        border-color: #10b981;
        background-color: #f0fdf4;
        box-shadow: 0 0 0 1px #10b981;
      }

      /* Added reward milestone animations */
      @keyframes reward-pop {
        0% {
          transform: scale(0.8);
          opacity: 0;
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .reward-popup {
        animation: reward-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)
          forwards;
      }

      .progress-glow {
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
      }

      /* Updated styles for the new reward location and hover states */
      .reward-tag {
        animation: slide-in-top 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)
          forwards;
        position: absolute;
        top: 0;
        right: 0;
        z-index: 20;
      }

      @keyframes slide-in-top {
        0% {
          transform: translateY(-20px) scale(0.9);
          opacity: 0;
        }
        100% {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
      }

      .tooltip-custom {
        visibility: hidden;
        opacity: 0;
        transition: all 0.3s ease;
      }

      .reward-tag:hover .tooltip-custom {
        visibility: visible;
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>
  <body class="bg-[#fafafa] min-h-screen text-[#1a1a1a]">
    <!-- Navigation / Header -->
    <nav
      class="fixed top-0 w-full bg-white/80 backdrop-blur-md border-b border-gray-100 z-50"
    >
      <div
        class="max-w-5xl mx-auto px-6 h-16 flex items-center justify-between"
      >
        <div class="flex items-center gap-2">
          <div
            class="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center text-white"
          >
            <i data-lucide="leaf" class="w-5 h-5"></i>
          </div>
          <span class="font-bold text-xl tracking-tight">Fruitful</span>
        </div>
        <div class="flex items-center gap-4">
          <div class="w-8 h-8 flex items-center justify-center">
            <i data-lucide="info" class="w-5 h-5 text-gray-400"></i>
          </div>
        </div>
      </div>
    </nav>

    <main class="pt-32 pb-20 px-6">
      <div
        class="max-w-2xl mx-auto relative bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm"
      >
        <!-- Moved the reward badge inside the form container at the top right -->
        <div id="reward-badge-container" class="absolute top-6 right-6 hidden">
          <div
            class="reward-tag relative group cursor-pointer flex items-center gap-2 bg-emerald-100 text-emerald-700 px-4 py-2 rounded-full border border-emerald-200 shadow-sm transition-all hover:bg-emerald-200"
            onclick="showRewardTip()"
            onmouseenter="showRewardTip()"
          >
            <i data-lucide="gift" class="w-4 h-4"></i>
            <span class="text-xs font-bold uppercase tracking-wider"
              >Rewards: <span id="reward-count-val">0</span></span
            >

            <!-- Tooltip -->
            <div
              class="tooltip-custom absolute top-full right-0 mt-2 w-48 bg-slate-900 text-white text-[10px] p-3 rounded-xl shadow-xl pointer-events-none z-50 transform translate-y-2"
            >
              <p class="leading-relaxed">
                Stay patient! Your rewards will be delivered once you complete
                all steps.
              </p>
              <div
                class="absolute -top-1 right-6 w-2 h-2 bg-slate-900 rotate-45"
              ></div>
            </div>
          </div>
        </div>

        <!-- Progress Section -->
        <div class="mb-12">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-2">
              <span
                id="step-category"
                class="text-xs font-semibold uppercase tracking-wider text-emerald-600 bg-emerald-50 px-2 py-1 rounded"
                >Personalization</span
              >
              <span class="text-xs font-medium text-gray-400"
                >Step <span id="current-step-label">1</span> of 8</span
              >
            </div>
            <span id="percent-label" class="text-sm font-bold text-gray-900"
              >12%</span
            >
          </div>
          <div class="h-1.5 w-full bg-gray-100 rounded-full overflow-hidden">
            <div
              id="progress-bar"
              class="h-full bg-emerald-500 transition-all duration-700 ease-in-out"
              style="width: 12.5%"
            ></div>
          </div>
        </div>

        <!-- Survey Content Container -->
        <div id="survey-content" class="animate-slide-in">
          <!-- Content injected via JS -->
        </div>

        <!-- Navigation Buttons -->
        <div id="nav-container" class="mt-12 flex items-center justify-between">
          <button
            id="prev-btn"
            onclick="prevStep()"
            class="flex items-center gap-2 text-sm font-semibold text-gray-400 hover:text-gray-900 transition-colors opacity-0 pointer-events-none"
          >
            <i data-lucide="arrow-left" class="w-4 h-4"></i>
            Back
          </button>
          <!-- Disabled auto-advance: users must click this button to proceed -->
          <button
            id="next-btn"
            onclick="nextStep()"
            class="bg-gray-900 text-white px-8 py-3.5 rounded-full font-semibold text-sm hover:bg-black transition-all hover:shadow-lg active:scale-95 disabled:opacity-50 disabled:pointer-events-none"
            disabled
          >
            Continue
          </button>
        </div>
      </div>
    </main>

    <!-- Reward Milestone Modal -->
    <div
      id="reward-modal"
      class="fixed inset-0 z-[100] hidden items-center justify-center p-6 bg-slate-900/40 backdrop-blur-sm"
    >
      <div
        class="max-w-md w-full bg-white rounded-[2.5rem] shadow-2xl p-10 text-center reward-popup"
      >
        <div
          class="w-24 h-24 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-lg rotate-3"
        >
          <i data-lucide="gift" class="w-12 h-12 text-white"></i>
        </div>
        <h2 class="text-4xl font-black text-slate-900 mb-4 leading-tight">
          Reward Unlocked!
        </h2>
        <div
          class="bg-emerald-50 p-6 rounded-2xl mb-8 border border-emerald-100"
        >
          <p id="reward-text" class="text-emerald-800 font-bold text-lg mb-1">
            üéÅ Premium Benefit Unlocked
          </p>
          <p class="text-emerald-600 text-sm">
            Added to your claimable balance
          </p>
        </div>
        <p class="text-slate-500 mb-10 text-lg leading-relaxed">
          Fantastic work! You've reached a milestone. Continue to the end to
          collect all your benefits.
        </p>
        <button
          onclick="closeRewardModal()"
          class="w-full py-5 bg-slate-900 text-white rounded-2xl font-black text-xl hover:bg-slate-800 transition-all shadow-xl hover:-translate-y-1"
        >
          Keep Going! üöÄ
        </button>
      </div>
    </div>

    <script>
      // Lucide implementation
      lucide.createIcons();

      let currentStep = 1;
      const totalSteps = 8;
      let selections = {};
      let cartCount = 0;

      const stepsData = {
        1: {
          category: "Discovery",
          title: "Why are you joining Fruitful?",
          desc: "Help us tailor your experience to your specific goals.",
          options: [
            {
              icon: "banknote",
              title: "Save money on groceries",
              sub: "Reduce monthly spending",
              color: "text-blue-600",
              bg: "bg-blue-50",
            },
            {
              icon: "apple",
              title: "Eat healthier meals",
              sub: "Access fresh produce",
              color: "text-emerald-600",
              bg: "bg-emerald-50",
            },
            {
              icon: "clock",
              title: "Save time shopping",
              sub: "Smart delivery services",
              color: "text-purple-600",
              bg: "bg-purple-50",
            },
          ],
        },
        2: {
          category: "Habits",
          title: "How often do you shop?",
          desc: "This helps us suggest the best delivery frequency.",
          options: [
            {
              icon: "calendar-days",
              title: "Daily",
              sub: "Fresh items every day",
              color: "text-emerald-600",
              bg: "bg-emerald-50",
            },
            {
              icon: "calendar",
              title: "Weekly",
              sub: "The most popular choice",
              color: "text-indigo-600",
              bg: "bg-indigo-50",
            },
            {
              icon: "calendar-range",
              title: "Monthly",
              sub: "Bulk savings and staples",
              color: "text-amber-600",
              bg: "bg-amber-50",
            },
          ],
        },
        3: {
          category: "Lifestyle",
          title: "Household size?",
          desc: "We'll customize our portions and bundle sizes.",
          isMilestone: true,
          rewardLabel: "üéÅ Family Plan Bonus Unlocked!",
          options: [
            {
              icon: "user",
              title: "Just me",
              sub: "Single person household",
              color: "text-rose-600",
              bg: "bg-rose-50",
            },
            {
              icon: "users",
              title: "Couple",
              sub: "Two person household",
              color: "text-cyan-600",
              bg: "bg-cyan-50",
            },
            {
              icon: "home",
              title: "Family",
              sub: "3+ person household",
              color: "text-violet-600",
              bg: "bg-violet-50",
            },
          ],
        },
        4: {
          category: "Budget",
          title: "What's your monthly budget?",
          desc: "We want to make sure we fit into your financial plan.",
          options: [
            {
              icon: "wallet",
              title: "Under $200",
              sub: "Budget conscious",
              color: "text-slate-600",
              bg: "bg-slate-50",
            },
            {
              icon: "coins",
              title: "$200 - $500",
              sub: "Average household",
              color: "text-yellow-600",
              bg: "bg-yellow-50",
            },
            {
              icon: "gem",
              title: "$500+",
              sub: "Premium selection",
              color: "text-indigo-600",
              bg: "bg-indigo-50",
            },
          ],
        },
        5: {
          category: "Preferences",
          title: "Dietary preferences?",
          desc: "Select your primary eating style.",
          options: [
            {
              icon: "leaf",
              title: "Plant-based",
              sub: "Vegan & Vegetarian",
              color: "text-emerald-600",
              bg: "bg-emerald-50",
            },
            {
              icon: "beef",
              title: "Everything",
              sub: "No restrictions",
              color: "text-red-600",
              bg: "bg-red-50",
            },
            {
              icon: "zap",
              title: "Keto / Paleo",
              sub: "High protein, low carb",
              color: "text-orange-600",
              bg: "bg-orange-50",
            },
          ],
        },
        6: {
          category: "Health",
          title: "Primary health goal?",
          desc: "What do you want to achieve with Fruitful?",
          isMilestone: true,
          rewardLabel: "üöÄ Wellness Booster Unlocked!",
          options: [
            {
              icon: "dumbbell",
              title: "Build Muscle",
              sub: "Protein focused",
              color: "text-blue-600",
              bg: "bg-blue-50",
            },
            {
              icon: "heart",
              title: "Heart Health",
              sub: "Low sodium & fresh",
              color: "text-rose-600",
              bg: "bg-rose-50",
            },
            {
              icon: "brain",
              title: "Mental Clarity",
              sub: "Superfoods & antioxidants",
              color: "text-amber-600",
              bg: "bg-amber-50",
            },
          ],
        },
        7: {
          category: "Expectations",
          title: "Your main expectation?",
          desc: "What's the one thing we must get right?",
          options: [
            {
              icon: "truck",
              title: "Fast Delivery",
              sub: "Under 2 hours",
              color: "text-indigo-600",
              bg: "bg-indigo-50",
            },
            {
              icon: "shield-check",
              title: "Quality",
              sub: "Hand-picked freshness",
              color: "text-emerald-600",
              bg: "bg-emerald-50",
            },
            {
              icon: "tag",
              title: "Best Prices",
              sub: "Lowest in the market",
              color: "text-yellow-600",
              bg: "bg-yellow-50",
            },
          ],
        },
        8: {
          category: "Final Step",
          title: "Claim your rewards",
          desc: "Enter your details to receive your collected benefits.",
          isFinal: true,
        },
      };

      function selectOption(element, step) {
        const stepContainer = document.getElementById(`step-${step}`);
        const cards = stepContainer.querySelectorAll(".option-card");
        cards.forEach((card) => {
          card.classList.remove("selected");
          card
            .querySelector(".check-circle")
            .classList.remove("bg-emerald-500", "border-emerald-500");
          card.querySelector(".lucide-check").classList.add("opacity-0");
        });

        element.classList.add("selected");
        const check = element.querySelector(".check-circle");
        check.classList.add("bg-emerald-500", "border-emerald-500");
        element.querySelector(".lucide-check").classList.remove("opacity-0");

        selections[step] = element.querySelector("h3").innerText;

        document.getElementById("next-btn").disabled = false;
      }

      function updateCart() {
        cartCount++;
        const container = document.getElementById("reward-badge-container");
        container.classList.remove("hidden");

        const badge = document.getElementById("reward-count-val");
        badge.innerText = cartCount;

        const tag = container.querySelector(".reward-tag");
        tag.classList.add("scale-110", "bg-emerald-300");
        setTimeout(
          () => tag.classList.remove("scale-110", "bg-emerald-300"),
          300
        );
      }

      function showRewardTip() {
        // Sweet toast-like notification logic
        const tip = document.createElement("div");
        tip.className =
          "fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 animate-bounce z-[200]";
        tip.innerHTML = `
                <i data-lucide="sparkles" class="  w-5 h-5 text-yellow-400"></i>
                <span class=" text-sm font-medium">Patience! You'll get your rewards after Step 8!</span>
            `;
        document.body.appendChild(tip);
        lucide.createIcons();
        setTimeout(() => tip.remove(), 3000);
      }

      function closeRewardModal() {
        const modal = document.getElementById("reward-modal");
        modal.classList.add("hidden");
        modal.classList.remove("flex");

        currentStep++;
        renderStep(currentStep);
        updateProgress();
      }

      function renderStep(step) {
        const data = stepsData[step];
        const content = document.getElementById("survey-content");
        content.style.opacity = "0";

        setTimeout(() => {
          if (data.isFinal) {
            renderFinalForm(content);
          } else {
            renderOptions(content, step, data);
          }

          lucide.createIcons();
          content.style.opacity = "1";
          content.classList.remove("animate-slide-in");
          void content.offsetWidth;
          content.classList.add("animate-slide-in");
        }, 200);
      }

      function renderOptions(content, step, data) {
        let optionsHtml = data.options
          .map(
            (opt) => `
                <button onclick="selectOption(this, ${step})" class="option-card flex items-center justify-between p-5 border-2 border-gray-100 rounded-2xl bg-white text-left group">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-xl ${opt.bg} flex items-center justify-center ${opt.color} group-hover:opacity-80 transition-colors">
                            <i data-lucide="${opt.icon}" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-900">${opt.title}</h3>
                            <p class="text-sm text-gray-500">${opt.sub}</p>
                        </div>
                    </div>
                    <div class="check-circle w-6 h-6 rounded-full border-2 border-gray-100 flex items-center justify-center transition-all group-hover:border-emerald-200">
                        <i data-lucide="check" class="w-4 h-4 text-white opacity-0 transition-opacity"></i>
                    </div>
                </button>
            `
          )
          .join("");

        content.innerHTML = `
                <div id="step-${step}" class="survey-step">
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold mb-3 tracking-tight">${data.title}</h1>
                        <p class="text-gray-500 text-lg">${data.desc}</p>
                    </div>
                    <div class="grid gap-4">
                        ${optionsHtml}
                    </div>
                </div>
            `;
      }

      function renderFinalForm(content) {
        content.innerHTML = `
                <div id="step-8" class="survey-step">
                    <div class="mb-8 text-center">
                        <div class="w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="trophy" class="w-8 h-8"></i>
                        </div>
                        <h1 class="text-3xl font-bold mb-3 tracking-tight">Claim Your Rewards</h1>
                        <p class="text-gray-500 text-lg">You've unlocked ${cartCount} premium benefits! Tell us where to send them.</p>
                    </div>
                    <div class="space-y-4">
                        <div class="relative">
                            <i data-lucide="user" class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="text" id="name" placeholder="Full Name" class="w-full pl-12 pr-4 py-4 bg-white border-2 border-gray-100 rounded-2xl focus:border-emerald-500 focus:outline-none transition-all font-medium">
                        </div>
                        <div class="relative">
                            <i data-lucide="mail" class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="email" id="email" placeholder="Email Address" class="w-full pl-12 pr-4 py-4 bg-white border-2 border-gray-100 rounded-2xl focus:border-emerald-500 focus:outline-none transition-all font-medium">
                        </div>
                        <div class="relative">
                            <i data-lucide="phone" class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                            <input type="tel" id="mobile" placeholder="Mobile Number" class="w-full pl-12 pr-4 py-4 bg-white border-2 border-gray-100 rounded-2xl focus:border-emerald-500 focus:outline-none transition-all font-medium">
                        </div>
                    </div>
                </div>
            `;
        document.getElementById("next-btn").innerText = "Claim All Rewards üéÅ";
        document.getElementById("next-btn").disabled = false;
      }

      function updateProgress() {
        const progress = (currentStep / totalSteps) * 100;
        document.getElementById("progress-bar").style.width = `${progress}%`;
        document.getElementById("percent-label").innerText = `${Math.round(
          progress
        )}%`;
        document.getElementById("current-step-label").innerText = currentStep;
        document.getElementById("step-category").innerText =
          stepsData[currentStep].category;

        const prevBtn = document.getElementById("prev-btn");
        if (currentStep > 1) {
          prevBtn.classList.remove("opacity-0", "pointer-events-none");
        } else {
          prevBtn.classList.add("opacity-0", "pointer-events-none");
        }

        const nextBtn = document.getElementById("next-btn");
        if (currentStep < totalSteps) {
          nextBtn.innerText = "Continue";
          nextBtn.disabled = !selections[currentStep];
        }
      }

      function nextStep() {
        const data = stepsData[currentStep];

        if (data.isMilestone && !data.rewardGiven) {
          data.rewardGiven = true;
          showRewardModal(data.rewardLabel);
          return; // Modal handles progression
        }

        if (currentStep < totalSteps) {
          currentStep++;
          renderStep(currentStep);
          updateProgress();
        } else {
          completeSurvey();
        }
      }

      function prevStep() {
        if (currentStep > 1) {
          currentStep--;
          renderStep(currentStep);
          updateProgress();
        }
      }

      function showSuccess(name) {
        triggerConfetti();
        const container = document.querySelector("main .max-w-2xl");
        document.getElementById("nav-container").style.display = "none";

        container.innerHTML = `
                <div class="text-center animate-slide-in pt-10">
                    <div class="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-8">
                        <i data-lucide="check-circle" class="w-10 h-10"></i>
                    </div>
                    <h1 class="text-4xl font-bold mb-4 tracking-tight">Success, ${
                      name.split(" ")[0]
                    }!</h1>
                    <p class="text-gray-500 text-lg mb-12 leading-relaxed">Your collection of ${cartCount} premium rewards has been secured. We've sent a confirmation to your email.</p>
                    <button onclick="location.reload()" class="bg-emerald-500 text-white px-10 py-4 rounded-full font-bold hover:bg-emerald-600 transition-all shadow-lg hover:shadow-emerald-200">
                        Back to Home
                    </button>
                </div>
            `;
        lucide.createIcons();
        document.querySelector("#cart-badge").parentElement.style.display =
          "none";
      }

      function showRewardModal(label) {
        const modal = document.getElementById("reward-modal");
        modal.classList.remove("hidden");
        modal.classList.add("flex");
        document.getElementById("reward-text").innerText = label;
        updateCart();
      }

      function triggerConfetti() {
        canvasConfetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 },
        });
      }

      function completeSurvey() {
        const name = document.getElementById("name").value;
        if (!name) {
          alert("Please enter your details to claim your rewards!");
          return;
        }
        showSuccess(name);
      }

      // Initial render
      renderStep(1);
    </script>
  </body>
</html>
